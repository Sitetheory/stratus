!function(o,i){"function"==typeof define&&define.amd?define(["text","underscore","bowser","promise","backbone","jquery"],function(e,t,n){return o.Stratus=i(e,t,n)}):o.Stratus=i(o.text,o._,o.bowser)}(this,function(e,p,t){var f={Settings:{image:{size:{xs:200,s:400,m:600,l:800,xl:1200,hq:1600}},status:{reset:-2,deleted:-1,inactive:0,active:1},consent:{reject:-1,pending:0,accept:1}},DOM:{},Key:{},PostMessage:{},LocalStorage:{},Selector:{},Select:null,BaseUrl:(requirejs&&p.has(requirejs.s.contexts._,"config")?requirejs.s.contexts._.config.baseUrl:null)||"/",BundlePath:(requirejs&&p.has(requirejs.s.contexts._,"config")?requirejs.s.contexts._.config.bundlePath:"")||"",Collections:null,Models:null,Routers:null,Views:{Plugins:{},Widgets:{}},Events:{},Relations:{},Apps:{},Catalog:{},Compendium:{},Components:{},Controllers:{},Directives:{},Filters:{},Modules:{ngMaterial:!0,ngMessages:!0},Services:{},Client:t,CSS:{},Chronos:null,Environment:{ip:null,production:!("string"==typeof document.cookie&&-1!==document.cookie.indexOf("env=")),context:null,contextId:null,contextMasterSiteId:null,siteId:null,masterSiteId:null,language:navigator.language,timezone:null,trackLocation:0,trackLocationConsent:0,lat:null,lng:null,postalCode:null,city:null,region:null,country:null,debugNest:!1,liveEdit:!1,viewPortChange:!1,lastScroll:!1},History:{},Instances:{},Internals:{},Loaders:{},Prototypes:{},Resources:{},Roster:{controller:{selector:"[ng-controller]",namespace:"stratus.controllers."},components:{namespace:"stratus.components."},directives:{namespace:"stratus.directives.",type:"attribute"},flex:{selector:"[flex]",require:["angular","angular-material"]},chart:{selector:"[chart]",require:["angular","angular-chart"],module:!0,suffix:".js"},sortable:{selector:"[ng-sortable]",require:["angular-sortable"],module:"ng-sortable"},modules:{selector:["[ng-sanitize]","[froala]"],namespace:"angular-",module:!0},countUp:{selector:["[count-up]","[scroll-spy]"],namespace:"angular-",module:!0,suffix:"Module"},uiTree:{selector:"[ui-tree]",require:["angular-ui-tree"],module:"ui.tree"}},PluginMethods:{},RegisterGroup:{},Api:{GoogleMaps:"AIzaSyBatGvzPR7u7NZ3tsCy93xj4gEBfytffyA",Froala:"FB2C2D2B1uB5A2B2D3A5F1D4E1A3B17hfE-13cA-9mrI-7sogE4in=="}};f.Environment.production||console.group("Stratus Warm Up"),p.templateSettings={evaluate:/\{%(.+?)%\}/g,interpolate:/\{\{(.+?)\}\}/g,escape:/\{#(.+?)#\}/g},p.mixin({createClass:function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}(),possibleConstructorReturn:function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},inherits:function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&Object.setPrototypeOf(e,t)},classCallCheck:function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},inherit:function(e,n){var o=function(e){p.classCallCheck(this,o);var t=p.possibleConstructorReturn(this,Object.getPrototypeOf(o).call(this,e,e));return p.extend(t,n),t};return p.inherits(o,e),o},ucfirst:function(e){return"string"==typeof e&&e?e.charAt(0).toUpperCase()+e.substring(1):null},lcfirst:function(e){return"string"==typeof e&&e?e.charAt(0).toLowerCase()+e.substring(1):null},cookie:function(e,t,n,o,i){var s={name:e,value:t,expires:n,path:o||"/",domain:i};if(e&&"object"==typeof e&&p.extend(s,e),void 0===s.value){var r=new RegExp("(?:^"+s.name+"|;\\s*"+s.name+")=(.*?)(?:;|$)","g").exec(document.cookie);return null===r?null:r[1]}var a=s.name+"="+escape(s.value)+";";s.expires&&(s.expires instanceof Date?isNaN(s.expires.getTime())&&(s.expires=new Date):s.expires=new Date((new Date).getTime()+1e3*p.seconds(s.expires)),a+="expires="+s.expires.toUTCString()+";"),s.path&&(a+="path="+s.path+";"),s.domain&&(a+="domain="+s.domain+";"),document.cookie=a},converge:function(e,t){if("string"!=typeof t&&(t="min"),"min"===t){var n=p.min(e);return p.findKey(e,function(e){return e===n})}if("radial"===t);else if("gauss"!==t)return e},repeat:function(e,t){var n;if("function"==typeof e&&"number"==typeof t)for(n=0;n<t;n++)e();else console.warn("Underscore cannot repeat function:",e,"with number of times:",t)},hydrate:function(e){return p.isJSON(e)?JSON.parse(e):e},hydrateString:function(e){return p.hydrate(e)},cloneDeep:function(e){if("object"!=typeof e)return e;var n=p.clone(e);return p.each(n,function(e,t){n[t]=p.cloneDeep(e)}),n},extendDeep:function(e,n){var o=p.clone(e);return n&&"object"==typeof n?p.each(n,function(e,t){o&&"object"==typeof o&&(o[t]=t in o?p.extendDeep(o[t],n[t]):n[t])}):o=n,o},getUrlParams:function(e,t){var o={};return(t=void 0!==t?t:window.location.href).replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,t,n){o[t]=n}),void 0!==e&&e?o[e]:o},allTrue:function(e){return"object"==typeof e&&p.every(e,function(e){return e})},isJSON:function(e){try{JSON.parse(e)}catch(e){return!1}return!0},isAngular:function(e){return"object"==typeof angular&&angular&&angular.element&&e instanceof angular.element},isjQuery:function(e){return"function"==typeof jQuery&&e instanceof jQuery},seconds:function(e){var t=0;if("string"==typeof e){var n=e.match(/([\d+.]*[\d+])(?=[sSmMhHdDwWyY]+)([sSmMhHdDwWyY]+)/gi);if(p.size(n)){var o,i,s,r=/([\d+.]*[\d+])(?=[sSmMhHdDwWyY]+)([sSmMhHdDwWyY]+)/i;p.each(n,function(e){if(o=r.exec(e),s=parseFloat(o[1]),i=o[2],!isNaN(s)){switch(o[2]){case"s":i=1;break;case"m":i=60;break;case"h":i=3600;break;case"d":i=86400;break;case"w":i=604800;break;case"y":i=31558149.504;break;default:i=0}t+=s*i}},this)}else t=null}else t="number"==typeof e?e:null;return t},camelToHyphen:function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},hyphenToCamel:function(e){return e.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})},snakeToCamel:function(e){return e.replace(/(_\w)/g,function(e){return e[1].toUpperCase()})},startsWith:function(e,t){return"string"==typeof e&&e.substr(0,t.length).toUpperCase()===t.toUpperCase()},patch:function(e,n){if(!p.isObject(e)||!p.size(e))return null;var o={},i={eax:void 0,ebx:void 0,ecx:void 0,edx:void 0};if(p.isObject(n)&&p.size(n)){var s=function(e,t){i.eax=i.ecx?i.ecx+"."+t:t,p.isObject(e)?(i.ecx=i.eax,p.each(e,s),i.ecx=i.ecx===t?void 0:i.ecx.substring(0,i.ecx.lastIndexOf("."))):(i.ebx=p.reduce(i.eax.split("."),function(e,t){return e&&e[t]},n),i.ebx!==e&&(i.edx=e)),void 0!==i.edx&&(o[i.eax]=e,i.edx=void 0)};p.each(e,s)}else console.error("bad prior:",n);return o&&p.size(o)?o:null},strcmp:function(e,t){e=e.toString(),t=t.toString();for(var n=0,o=Math.max(e.length,t.length);n<o&&e.charAt(n)===t.charAt(n);++n);return n===o?0:e.charAt(n)>t.charAt(n)?-1:1},truncate:function(e,t,n){t=t||100,n=n||"...";for(var o,i,s,r,a,l=e.replace(/</g,"\n<").replace(/>/g,">\n").replace(/\n\n/g,"\n").replace(/^\n/g,"").replace(/\n$/g,"").split("\n"),c=0,u=[],d=0;d<l.length;d++){var h=(o=l[d]).replace(/[ ]+/g," ");if(o.length){if("<"!==o[0])if(t<=c)o="";else if(c+h.length>=t){if(" "===o[(i=t-c)-1])for(;i&&" "===o[(i-=1)-1];);else-1!==(s=o.substring(i).split("").indexOf(" "))?i+=s:i=o.length;o=o.substring(0,i)+n,c=t}else c+=h.length;else if(t<=c)if(a=(r=o.match(/[a-zA-Z]+/))?r[0]:"")if("</"!==o.substring(0,2))u.push(a),o="";else{for(;u[u.length-1]!==a&&u.length;)u.pop();u.length&&(o=""),u.pop()}else o="";l[d]=o}}return l.join("\n").replace(/\n/g,"")}}),"function"==typeof $&&$.fn&&($.fn.notClicked=function(e){return this.selector||this.context||console.error("No Selector or Context:",this),!$(e.target).closest(this.selector||this.context).length&&!$(e.target).parents(this.selector||this.context).length});var a=/\s+/,l=function(e,t,n,o,i){var s,r=0;if(n&&"object"==typeof n){void 0!==o&&"context"in i&&void 0===i.context&&(i.context=o);for(s=p.keys(n);r<s.length;r++)t=l(e,t,s[r],n[s[r]],i)}else if(n&&a.test(n))for(s=n.split(a);r<s.length;r++)t=e(t,s[r],o,i);else t=e(t,n,o,i);return t};f.Events.on=function(e,t,n){return c(this,e,t,n)};var c=function(e,t,n,o,i){(e._events=l(s,e._events||{},t,n,{context:o,ctx:e,listening:i}),i)&&((e._listeners||(e._listeners={}))[i.id]=i);return e};f.Events.listenTo=function(e,t,n){if(!e)return this;var o=e._listenId||(e._listenId=p.uniqueId("l")),i=this._listeningTo||(this._listeningTo={}),s=i[o];if(!s){var r=this._listenId||(this._listenId=p.uniqueId("l"));s=i[o]={obj:e,objId:o,id:r,listeningTo:i,count:0}}return c(e,t,n,this,s),this};var s=function(e,t,n,o){if(n){var i=e[t]||(e[t]=[]),s=o.context,r=o.ctx,a=o.listening;a&&a.count++,i.push({callback:n,context:s,ctx:s||r,listening:a})}return e};f.Events.off=function(e,t,n){return this._events&&(this._events=l(o,this._events,e,t,{context:n,listeners:this._listeners})),this},f.Events.stopListening=function(e,t,n){var o=this._listeningTo;if(!o)return this;for(var i=e?[e._listenId]:p.keys(o),s=0;s<i.length;s++){var r=o[i[s]];if(!r)break;r.obj.off(t,n,this)}return this};var o=function(e,t,n,o){if(e){var i,s=0,r=o.context,a=o.listeners;if(t||n||r){for(var l=t?[t]:p.keys(e);s<l.length;s++){var c=e[t=l[s]];if(!c)break;for(var u=[],d=0;d<c.length;d++){var h=c[d];n&&n!==h.callback&&n!==h.callback._callback||r&&r!==h.context?u.push(h):(i=h.listening)&&0==--i.count&&(delete a[i.id],delete i.listeningTo[i.objId])}u.length?e[t]=u:delete e[t]}return e}for(var f=p.keys(a);s<f.length;s++)delete a[(i=a[f[s]]).id],delete i.listeningTo[i.objId]}};f.Events.once=function(e,t,n){var o=l(i,{},e,t,p.bind(this.off,this));return"string"==typeof e&&null==n&&(t=void 0),this.on(o,t,n)},f.Events.listenToOnce=function(e,t,n){var o=l(i,{},t,n,p.bind(this.stopListening,this,e));return this.listenTo(e,o)};var i=function(e,t,n,o){if(n){var i=e[t]=p.once(function(){o(t,i),n.apply(this,arguments)});i._callback=n}return e};f.Events.trigger=function(e){if(!this._events)return this;for(var t=Math.max(0,arguments.length-1),n=Array(t),o=0;o<t;o++)n[o]=arguments[o+1];return l(r,this._events,e,void 0,n),this};var r=function(e,t,n,o){if(e){var i=e[t],s=e.all;i&&s&&(s=s.slice()),i&&u(i,o),s&&u(s,[t].concat(o))}return e},u=function(e,t){var n,o=-1,i=e.length,s=t[0],r=t[1],a=t[2];switch(t.length){case 0:for(;++o<i;)(n=e[o]).callback.call(n.ctx);return;case 1:for(;++o<i;)(n=e[o]).callback.call(n.ctx,s);return;case 2:for(;++o<i;)(n=e[o]).callback.call(n.ctx,s,r);return;case 3:for(;++o<i;)(n=e[o]).callback.call(n.ctx,s,r,a);return;default:for(;++o<i;)(n=e[o]).callback.apply(n.ctx,t)}};return f.Events.bind=f.Events.on,f.Events.unbind=f.Events.off,f.Prototypes.Error=function(e,t){this.code="Internal",this.message="No discernible data received.",this.chain=[],"string"==typeof e?this.message=e:e&&"object"==typeof e&&p.extend(this,e),this.chain.push(t)},f.Prototypes.Dispatch=function(){return p.extend(this,f.Events)},f.Prototypes.Job=function(e,t,n){return this.enabled=!1,e&&"object"==typeof e?p.extend(this,e):(this.time=e,this.method=t,this.scope=n),this.time=p.seconds(this.time),this.scope=this.scope||window,this},f.Prototypes.Model=function(e){return this.data={},this.attributes=this.data,this.temps={},this.toObject=function(e){return p.clone(this.data)},this.toJSON=function(e){return p.clone(this.data)},this.each=function(e,t){p.each.apply(void 0===t?this:t,p.union([this.data],arguments))},this.get=function(e){return p.reduce("string"==typeof e?e.split("."):[],function(e,t){return e&&e[t]},this.data)},this.has=function(e){return void 0!==this.get(e)},this.size=function(){return p.size(this.data)},this.set=function(e,t){e&&"object"==typeof e?p.each(e,function(e,t){this.setAttribute(t,e)},this):this.setAttribute(e,t)},this.setAttribute=function(e,t){if("string"==typeof e)if(-1!==e.indexOf(".")){var n=this.data,o=e.split(".");if(p.find(p.initial(o),function(e){if(p.has(n,e)&&n[e]||(n[e]={}),void 0===n||!n||"object"!=typeof n)return n=this.data,!0;n=n[e]},this),!p.isEqual(n,this.data)){var i=p.last(o);!n||"object"!=typeof n||p.has(n,i)&&p.isEqual(n[i],t)||(n[i]=t,this.trigger("change:"+e,this))}}else p.has(this.data,e)&&p.isEqual(this.data[e],t)||(this.data[e]=t,this.trigger("change:"+e,this))},this.temp=function(e,t){this.set(e,t),e&&"object"==typeof e?p.each(e,function(e,t){this.temps[t]=e},this):this.temps[e]=t},this.add=function(e,t){if(this.has(e)||this.set(e,[]),void 0!==t&&!p.contains(this.data[e],t))return this.data[e].push(t),t},this.remove=function(e,t){return void 0===t||(this.data[e]=p.without(this.data[e],t)),this.data[e]},this.iterate=function(e){return this.has(e)||this.set(e,0),++this.data[e]},this.clear=function(){for(var e in this.data)this.data.hasOwnProperty(e)&&delete this.data[e]},this.clearTemp=function(){for(var e in this.temps)this.temps.hasOwnProperty(e)&&delete this.temps[e]},this.initialize=function(){return!0},e&&p.extend(this.data,e),p.extend(this,f.Events),this.reinitialize=function(){this.initialize.apply(this,arguments)}.bind(this),this.reinitialize(),this},f.Collections=new f.Prototypes.Model,f.Models=new f.Prototypes.Model,f.Routers=new f.Prototypes.Model,f.Environment=new f.Prototypes.Model(f.Environment),f.Prototypes.Sentinel=function(){return this.view=!1,this.create=!1,this.edit=!1,this.delete=!1,this.publish=!1,this.design=!1,this.dev=!1,this.master=!1,this.zero=function(){p.extend(this,{view:!1,create:!1,edit:!1,delete:!1,publish:!1,design:!1,dev:!1,master:!1})},this.permissions=function(e){if(isNaN(e)){var t=0;return t+=this.view?1:0,t+=this.create?2:0,t+=this.edit?4:0,t+=this.delete?8:0,t+=this.publish?16:0,t+=this.design?32:0,t+=this.dev?64:0,t+=this.master?128:0}p.each(e.toString(2).split("").reverse(),function(e,t){if("1"===e)switch(t){case 0:this.view=!0;break;case 1:this.create=!0;break;case 2:this.edit=!0;break;case 3:this.delete=!0;break;case 4:this.publish=!0;break;case 5:this.design=!0;break;case 6:this.dev=!0;break;case 7:this.view=!0,this.create=!0,this.edit=!0,this.delete=!0,this.publish=!0,this.design=!0,this.dev=!0,this.master=!0}},this)},this.summary=function(){var n=[];return p.each(this,function(e,t){"boolean"==typeof e&&e&&n.push(p.ucfirst(t))}),n},this},f.Prototypes.Bootbox=function(e,t){e&&"object"==typeof e?(p.extend(this,e),this.message=this.message||"Message"):this.message=e||"Message",this.handler=this.handler||t,"function"!=typeof this.handler&&(this.handler=function(e){console.info("Client "+(void 0===e?"closed":e?"confirmed":"cancelled")+" dialog.")})},f.Prototypes.Toast=function(e,t,n,o){e&&"object"==typeof e?(p.extend(this,e),this.message=this.message||"Message"):this.message=e||"Message",this.title=this.title||t||"Toast",this.priority=this.priority||n||"danger",this.settings=this.settings||o,this.settings&&"object"==typeof this.settings||(this.settings={}),this.settings.timeout=this.settings.timeout||1e4},f.Internals.Ajax=function(e){this.method="GET",this.url="/Api",this.data={},this.type="",this.success=function(e){return e},this.error=function(e){return e},p.extend(this,e);var o=this;this.xhr=new window.XMLHttpRequest;var t=new Promise(function(t,n){o.xhr.open(o.method,o.url,!0),"string"==typeof o.type&&o.type.length&&o.xhr.setRequestHeader("Content-Type",o.type),o.xhr.onload=function(){if(200<=o.xhr.status&&o.xhr.status<400){var e=o.xhr.responseText;p.isJSON(e)&&(e=JSON.parse(e)),t(e)}else n(o.xhr)},o.xhr.onerror=function(){n(o.xhr)},Object.keys(o.data).length?o.xhr.send(JSON.stringify(o.data)):o.xhr.send()});return t.then(o.success,o.error),t},f.Internals.Anchor=function e(){return e.initialize=!0,"object"!=typeof Backbone?e:Backbone.View.extend({el:'a[href*=\\#]:not([href=\\#]):not([data-scroll="false"])',events:{click:"clickAction"},clickAction:function(t){if(window.location.pathname.replace(/^\//,"")===t.currentTarget.pathname.replace(/^\//,"")&&window.location.hostname===t.currentTarget.hostname){if(p.every(["new","filter","page","version"],function(e){return!p.startsWith(t.currentTarget.hash,"#"+e)},this)&&"function"==typeof $&&$.fn&&"object"==typeof Backbone){var e=$(t.currentTarget.hash),n=t.currentTarget.hash.slice(1);if((e=e.length?e:$("[name="+n+"]")).length)return $("html,body").animate({scrollTop:e.offset().top},1e3,function(){Backbone.history.navigate(n)}),!1}}}})}(),f.Internals.Api=function(e,t,n){return void 0===e&&(e="Default"),null==t&&(t={}),void 0===n&&(n={}),"object"!=typeof t&&(t={method:t}),p.has(t,"method")||(t.method="GET"),f.Internals.Convoy({route:{controller:e},meta:t,payload:n})},f.Internals.Compatibility=function(){var e=[];f.Client.android?e.push("android"):f.Client.ios?e.push("ios"):f.Client.mac?e.push("mac"):f.Client.windows?e.push("windows"):f.Client.linux?e.push("linux"):e.push("os"),f.Client.chrome?e.push("chrome"):f.Client.firefox?e.push("firefox"):f.Client.safari?e.push("safari"):f.Client.opera?e.push("opera"):f.Client.msie?e.push("msie"):f.Client.iphone?e.push("iphone"):e.push("browser"),f.Client.version&&e.push("version"+f.Client.version.split(".")[0]),f.Client.mobile?e.push("mobile"):f.Client.tablet?e.push("tablet"):e.push("desktop"),f("body").addClass(e.join(" "))},f.Internals.Convoy=function(e,o){return new Promise(function(t,n){void 0===e&&n(new f.Prototypes.Error({code:"Convoy",message:"No Convoy defined for dispatch."},this)),"function"==typeof $&&$.ajax?$.ajax({type:"POST",url:"/Api"+encodeURIComponent(o||""),data:{convoy:JSON.stringify(e)},dataType:p.has(e,"meta")&&p.has(e.meta,"dataType")?e.meta.dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0,headers:{"Access-Control-Allow-Origin":"*"},success:function(e){return t(e),e},error:function(e){return n(new f.Prototypes.Error({code:"Convoy",message:e},this)),e}}):f.Internals.Ajax({method:"POST",url:"/Api"+encodeURIComponent(o||""),data:{convoy:JSON.stringify(e)},type:p.has(e,"meta")&&p.has(e.meta,"dataType")?e.meta.dataType:"application/json",success:function(e){return e=e.payload||e,t(e),e},error:function(e){return n(new f.Prototypes.Error({code:"Convoy",message:e},this)),e}})})},f.Internals.CssLoader=function(o){return new Promise(function(e,t){if(o in f.CSS)f.CSS[o]?e():f.Events.once("onload:"+o,e);else{f.CSS[o]=!1;var n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=o,f.Events.once("onload:"+o,function(){f.CSS[o]=!0,e()}),"onload"in n&&!f.Client.android?n.onload=function(){f.Events.trigger("onload:"+o)}:(f.CSS[o]=!0,f.Events.trigger("onload:"+o)),f("head").append(n)}})},f.Internals.GetColWidth=function(e){var t=e.attr("class"),n=/col-.{2}-([0-9]*)/g.exec(t);return void 0!==n[1]&&n[1]},f.Internals.GetScrollDir=function(){var e=$(window).scrollTop(),t=f.Environment.get("windowTop"),n=$(window).height(),o=$(document).height();return!!t&&t<e?"down":!!(!!t&&(e<t&&e+n<o))&&"up"},f.Internals.IsOnScreen=function(e,t){e=f(e),t=t||0;var n={wt:document.body.scrollTop,et:e.offset().top||null};return n.wb=n.wt+document.body.offsetHeight,n.eb=e.height()+(n.et||0),n.eb>=n.wt+t&&n.et<=n.wb-t},f.Internals.LoadCss=function(e){return new Promise(function(n,o){void 0!==e&&"function"!=typeof e||o(new f.Prototypes.Error({code:"LoadCSS",message:"CSS Resource URLs must be defined as a String, Array, or Object."},this)),"string"==typeof e&&(e=[e]);var i={total:e.length,iteration:0};0<i.total?p.each(e.reverse(),function(e){i.iteration++;var t=p.uniqueId("css_");i[t]=!1,void 0!==e&&e?f.Internals.CssLoader(e).then(function(e){i[t]=!0,i.total===i.iteration&&p.allTrue(i)&&n(i)},o):(i[t]=!0,i.total===i.iteration&&p.allTrue(i)&&n(i))}):o(new f.Prototypes.Error({code:"LoadCSS",message:"No CSS Resource URLs found!"},this))})},f.Internals.LoadEnvironment=function(){var e=f("body").attr("data-environment");e&&"object"==typeof e&&p.size(e)&&f.Environment.set(e)},f.Internals.LoadImage=function(u){var d=f(u.el);d.addClass("placeholder"),f.Internals.IsOnScreen(u.spy)&&!d.attr("data-loading")&&(d.attr("data-loading",!0),f.DOM.complete(function(){var e=d.attr("data-hd");void 0===e&&(e=!0);var t=d.attr("data-src");t&&"lazy"!==t||(t=d.attr("src"));var n=null;if(d.attr("data-size")&&!1!==n.indexOf(d.attr("data-size")))n=d.attr("data-size");else{var o=null,i=null,s=null;if(d.width()?o=d.width():d.attr("width")&&(o=d.attr("width")),o){i=(o=/([\d]+)(.*)/.exec(o))[2],o=parseInt(o[1]),s="%"===i?o/100:null}if(!o||"%"===i){var r=d.parent();o=r?r.width():0;var a=r.find('[class*="col-"]');if(0<a.length){var l=f.Internals.GetColWidth(a);l&&(o=Math.round(o/l))}s&&(o=Math.round(o*s))}if(o<=0)return d.attr("data-loading",!1),setTimeout(function(){f.Internals.LoadImage(u)},500),!1;e&&(o*=2),n=(n=p.findKey(f.Settings.image.size,function(e){var t=e/o;return.85<t&&t<1.15||o<e}))||"hq"}var c=/^(.+?)(-[A-Z]{2})?\.(?=[^.]*$)(.+)/gi.exec(t);t=c[1]+"-"+n+"."+c[3],d.attr("src",t.startsWith("//")?window.location.protocol+t:t),d.addClass("loading"),u.el.load?u.el.load(function(){d.addClass("loaded").removeClass("placeholder loading")}):d.addClass("loaded").removeClass("placeholder loading"),f.RegisterGroup.remove("OnScroll",u)}))},f.Internals.Location=function(n){return new Promise(function(e,t){"geolocation"in navigator?(n=p.extend({enableHighAccuracy:!0,timeout:2e4,maximumAge:5e4},n||{}),navigator.geolocation.getCurrentPosition(e,t,n)):t(new f.Prototypes.Error({code:"Location",message:"HTML5 Geo-Location isn't supported on this browser."},this))})},f.Internals.OnScroll=p.once(function(e){f.Environment.on("change:viewPortChange",function(e){if(e.get("viewPortChange")){e.set("lastScroll",f.Internals.GetScrollDir());var t=f.RegisterGroup.get("OnScroll");p.each(t,function(e){void 0!==e&&p.has(e,"method")&&e.method(e)}),e.set("viewPortChange",!1),e.set("windowTop",$(window).scrollTop())}}),"function"==typeof $&&$.fn&&($(window).scroll(function(){!1===f.Environment.get("viewPortChange")&&f.Environment.set("viewPortChange",!0)}),$(window).resize(function(){!1===f.Environment.get("viewPortChange")&&f.Environment.set("viewPortChange",!0)})),f.Environment.set("viewPortChange",!0)}),f.Internals.Resource=function(o,i){return new Promise(function(e,t){if(void 0===o&&t(new f.Prototypes.Error({code:"Resource",message:"Resource path is not defined."},this)),p.has(f.Resources,o))f.Resources[o].success?e(f.Resources[o].data):f.Events.once("resource:"+o,e);else{f.Resources[o]={success:!1,data:null},f.Events.once("resource:"+o,e);var n={path:o,dataType:"text"};void 0!==i&&(n.elementId=i),f.Internals.Api("Resource",n,{}).then(function(e){f.Resources[o].success=!0,f.Resources[o].data=e,f.Events.trigger("resource:"+o,e)},t)}})},f.Internals.SetUrlParams=function(e,t){if(void 0===t&&(t=window.location.href),void 0===e)return t;var o={},n=t.indexOf("?"),i=t.indexOf("#"),s="";return 0<=i&&(s=t.substring(i,t.length),t=t.substring(0,i)),t.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,t,n){o[t]=n}),o=p.extend(o,e),(0<=n?t.substring(0,n):t)+"?"+p.reduce(p.map(o,function(e,t){return t+"="+e}),function(e,t){return e+"&"+t})+s},f.Internals.TrackLocation=function(){var t={};t.timezone=(new Date).toString().match(/\((.*)\)/)[1],f.Environment.get("trackLocation")?f.Environment.get("trackLocationConsent")?f.Internals.Location().then(function(e){t.lat=e.coords.latitude,t.lng=e.coords.longitude,f.Environment.set("lat",e.coords.latitude),f.Environment.set("lng",e.coords.longitude),f.Internals.UpdateEnvironment(t)},function(e){console.error("Stratus Location:",e)}):f.Internals.Ajax({url:"https://ipapi.co/"+f.Environment.get("ip")+"/json/",success:function(e){e||(e={}),"object"==typeof e&&Object.keys(e).length&&e.postal&&(t.postalCode=e.postal,t.lat=e.latitude,t.lng=e.longitude,t.city=e.city,t.region=e.region,t.country=e.country,f.Internals.UpdateEnvironment(t))}}):f.Internals.UpdateEnvironment(t)},f.Internals.UpdateEnvironment=function(e){if(e||(e={}),"string"!=typeof document.cookie||!p.cookie("SITETHEORY"))return!1;"object"==typeof e&&Object.keys(e).length&&f.Internals.Ajax({method:"PUT",url:"/Api/Session",data:e,type:"application/json",success:function(e){var t=e.payload||e;"object"==typeof t&&p.each(Object.keys(t),function(e){f.Environment.set(e,t[e])})},error:function(e){console.error("error:",e)}})},f.Select=function(e,t){t||(t=document);var n=e;"string"==typeof e&&(n=t[p.startsWith(e,".")||p.contains(e,"[")?"querySelectorAll":p.contains(["html","head","body"],e)||p.startsWith(e,"#")?"querySelector":"querySelectorAll"](e));return n&&"object"==typeof n&&((p.isAngular(n)||p.isjQuery(n))&&(n=n.length?p.first(n):{}),n=p.extend({},f.Selector,{context:this,length:p.size(n),selection:n,selector:e})),n},(f=p.extend(function(e,t){return f.Select(e,t)},f)).Selector.attr=function(e,t){var n=this;if(n.selection instanceof window.NodeList)f.Environment.get("production")||console.log("List:",n);else if(e){if(void 0===t)return t=n.selection.getAttribute(e),p.isJSON(t)?JSON.parse(t):t;n.selection.setAttribute(e,"string"==typeof t?t:JSON.stringify(t))}return n},f.Selector.each=function(e){return"function"!=typeof e&&(e=function(e){console.warn("each running on element:",e)}),this.selection instanceof window.NodeList&&p.each(this.selection,e),this},f.Selector.find=function(e){if(this.selection instanceof window.NodeList)f.Environment.get("production")||console.log("List:",this);else if(e)return f(e,this.selection);return this},f.Selector.map=function(e){return"function"!=typeof e&&(e=function(e){console.warn("map running on element:",e)}),this.selection instanceof window.NodeList?p.map(this.selection,e):this},f.Selector.append=function(e){var t=this;return t.selection instanceof window.NodeList?f.Environment.get("production")||console.log("List:",t):e&&t.selection.insertBefore(e,t.selection.lastChild),t},f.Selector.prepend=function(e){var t=this;return t.selection instanceof window.NodeList?f.Environment.get("production")||console.log("List:",t):e&&t.selection.insertBefore(e,t.selection.firstChild),t},f.Selector.addClass=function(e){var t=this;return t.selection instanceof window.NodeList?f.Environment.get("production")||console.log("List:",t):p.each(e.split(" "),function(e){t.selection.classList?t.selection.classList.add(e):t.selection.className+=" "+e}),t},f.Selector.removeClass=function(e){var t=this;return t.selection instanceof window.NodeList?f.Environment.get("production")||console.log("List:",t):t.selection.classList?p.each(e.split(" "),function(e){t.selection.classList.remove(e)}):t.selection.className=t.selection.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," "),t},f.Selector.style=function(){var e=this;if(e.selection instanceof window.NodeList)f.Environment.get("production")||console.log("List:",e);else if(e.selection instanceof window.Node)return window.getComputedStyle(e.selection);return e},f.Selector.height=function(){return this.selection instanceof window.NodeList?(console.error("Unable to find height for element:",this.selection),this):this.selection.offsetHeight||0},f.Selector.width=function(){return this.selection instanceof window.NodeList?(console.error("Unable to find width for element:",this.selection),this):this.selection.offsetWidth||0},f.Selector.offset=function(){var e=this;if(e.selection instanceof window.NodeList)console.error("Unable to find offset for element:",e.selection);else if(e.selection.getBoundingClientRect){var t=e.selection.getBoundingClientRect();return{top:t.top+document.body.scrollTop,left:t.left+document.body.scrollLeft}}return e},f.Selector.parent=function(){return this.selection instanceof window.NodeList?(console.error("Unable to find offset for element:",this.selection),this):f(this.selection.parentNode)},f.Internals.Loader=function(e,a,l){if(void 0===e){var t=f("body");(e=t.attr("data-loaded")?null:"[data-entity],[data-plugin]")?t.attr("data-loaded",!0):console.warn("Attempting to load Stratus root repeatedly!")}return e&&(e=a&&e&&"object"==typeof e?f(e).find("[data-type],[data-plugin]"):f(e)),new Promise(function(i,s){var r={total:e&&"object"==typeof e?e.length:0,iteration:0,views:{}};0<r.total?e.each(function(e,t,n){r.iteration++;var o=p.uniqueId("entry_");r.views[o]=!1,f.Internals.ViewLoader(e,a,l).then(function(e){r.views[o]=e,r.total===r.iteration&&p.allTrue(r.views)&&i(r)},s)}):i(r)})},f.Internals.View=p.inherit(f.Prototypes.Model,{toObject:function(){var e=p.clone(this.data);return e.el&&e.el.selection&&(e.el=e.el.selection,"function"==typeof $&&$.fn&&(e.$el=$(e.el))),e},hydrate:function(){var e=this.get("el");if(this.set({uid:p.uniqueId("view_"),guid:void 0!==e.attr("data-guid")?e.attr("data-guid"):null,entity:void 0!==e.attr("data-entity")?p.ucfirst(e.attr("data-entity")):null,id:void 0!==e.attr("data-id")?e.attr("data-id"):null,manifest:void 0!==e.attr("data-manifest")?e.attr("data-manifest"):null,api:void 0!==e.attr("data-api")?e.attr("data-api"):null,fetch:void 0===e.attr("data-fetch")||e.attr("data-fetch"),target:void 0!==e.attr("data-target")?e.attr("data-target"):null,prototype:void 0!==e.attr("data-prototype")?e.attr("data-prototype"):null,autoSave:void 0!==e.attr("data-autoSave")?e.attr("data-autoSave"):null,type:void 0!==e.attr("data-type")?e.attr("data-type"):null,types:void 0!==e.attr("data-types")?e.attr("data-types"):null,template:void 0!==e.attr("data-template")?e.attr("data-template"):null,templates:void 0!==e.attr("data-templates")?e.attr("data-templates"):null,dialogue:void 0!==e.attr("data-dialogue")?e.attr("data-dialogue"):null,pagination:void 0!==e.attr("data-pagination")?e.attr("data-pagination"):null,property:void 0!==e.attr("data-property")?e.attr("data-property"):null,field:void 0!==e.attr("data-field")?e.attr("data-field"):null,load:void 0!==e.attr("data-load")?e.attr("data-load"):null,options:void 0!==e.attr("data-options")?e.attr("data-options"):null,versionEntity:void 0!==e.attr("data-versionentity")?e.attr("data-versionentity"):null,versionRouter:void 0!==e.attr("data-versionrouter")?e.attr("data-versionrouter"):null,versionId:void 0!==e.attr("data-versionid")?e.attr("data-versionid"):null,plugin:void 0!==e.attr("data-plugin")?e.attr("data-plugin"):null,plugins:[]}),null!==this.get("plugin")){var t=this.get("plugin").split(" ");null!==this.get("type")?this.set("plugins",1<t.length?t:[this.get("plugin")]):1<t.length&&(this.set("plugin",p.first(t)),this.set("plugins",p.rest(t)))}var n=this.get("id"),o=null!==this.get("type")?this.get("type"):this.get("plugin"),i=null!==this.get("type")?"widgets":"plugins";this.set({scope:null!==n?"model":"collection",alias:null!==o?"stratus.views."+i+"."+o.toLowerCase():null,path:null!==o?o:null}),n||null===this.get("entity")||null===this.get("manifest")||this.set("scope","model")},clean:function(){this.get("entity")&&"none"!==this.get("entity").toLowerCase()||this.set({entity:null,scope:null})},nest:function(){var e={entity:this.get("entity"),id:this.get("id"),versionEntity:this.get("versionEntity"),versionRouter:this.get("versionRouter"),versionId:this.get("versionId"),scope:this.get("scope"),manifest:this.get("manifest")};return this.has(e.scope)&&(e[e.scope]=this.get(e.scope)),e},modelAttributes:function(){return{id:this.get("id")}}}),f.Internals.ViewLoader=function(e,c,u){var t=c||null,n=!1,o=f(e);if((c=new f.Internals.View).set("el",o),c.hydrate(),t&&(c.has("entity")?n=!0:c.set(t.nest())),c.clean(),!n){void 0===u&&(u=["stratus"]);var i=c.get("template"),d=c.get("templates"),s=c.get("dialogue"),h=[];if(null!==c.get("scope")&&u.push("stratus."+c.get("scope")+"s.generic"),c.get("alias")&&p.has(requirejs.s.contexts._.config.paths,c.get("alias")))u.push(c.get("alias"));else if(c.get("path")){u.push(c.get("path"));var r=/(?=[^/]*$)([a-zA-Z]+)/i.exec(c.get("path"));c.set("type",p.ucfirst(r[1]))}else c.set({type:null,alias:null,path:null});if(null!==i&&(d=p.extend(null!==d?d:{},{combined:i})),null!==s&&(d=p.extend(null!==d?d:{},{dialogue:s})),null!==d){for(var a in d)if(d.hasOwnProperty(a)&&"function"!=typeof d[a])if(0===d[a].indexOf("#")){var l=$(d[a]);0<l.length&&(d[a]=l.html())}else d[a],requirejs.s.contexts._.config.paths,u.push("text!"+d[a]),h.push(a);c.set("templates",d),d=c.get("templates")}}return new Promise(function(a,l){return c.get("guid")?(f.Environment.get("production")||console.warn("View hydration halted on",c.get("guid"),"due to repeat calls on the same element.",c.toObject()),a(!0),!0):n?(a(!0),!0):void require(u,function(i){!i.Environment.get("production")&&i.Environment.get("nestDebug")&&console.group("Stratus View");var e=0;if(d&&0<h.length)for(var t=0;t<arguments.length;t++)"string"==typeof arguments[t]&&(-1===arguments[t].indexOf("<html")?d[h[e]]=arguments[t]:console.error("Template",d[h[e]],"failed to load."),e++);c.set("templates",d),d=c.get("templates");var s=[];if(0<p.size(d)){var r=/<.+?data-type=["|'](.+?)["|'].*>/gi;p.each(d,function(e,t){if("string"==typeof e){if(-1!==e.search(r))for(var n=r.exec(e);null!==n;){var o="stratus.views."+(c.get("plugin")?"plugins":"widgets")+"."+n[1].toLowerCase();o&&!p.has(requirejs.s.contexts._.config.paths,o)&&(i.Environment.get("production")||console.warn("Sub Type:",o,"not configured in require.js")),s.push(o),n=r.exec(e)}d[t]=p.template(e)}}),c.set("templates",d),d=c.get("templates")}c.get("plugins").length&&p.each(c.get("plugins"),function(e){s.push("stratus.views.plugins."+e.toLowerCase())});var n=[];null!==c.get("plugin")&&n.push("PluginLoader"),null!==c.get("type")&&n.push("WidgetLoader"),n.length||n.push("WidgetLoader"),p.each(n,function(o){0===p.size(s)?i.Internals[o](a,l,c,u):(u=p.union(u,s),new Promise(function(t,n){require(u,function(e){e.Internals[o](t,n,c,u)})}).then(a,l))})})})},f.Internals.WidgetLoader=function(t,n,e,o){if("model"===e.get("scope")){var i,s;f.Models.has(e.get("entity"))||f.Models.set(e.get("entity"),f.Models.Generic.extend({}));var r=!1,a=f.Models.has(e.get("entity"))?f.Models.get(e.get("entity")):null;!e.get("id")&&e.get("manifest")?(s=e.get("entity")+"Manifest",(i=f.Instances[s])||(f.Instances[s]=new a,i=f.Instances[s],r=!0)):a&&p.has(a,"findOrCreate")?(i=a.findOrCreate(e.get("id")))||(i=new a(e.modelAttributes()),r=!0):(s=e.get("entity")+e.get("id"),(i=f.Instances[s])||(f.Instances[s]=new a(e.modelAttributes()),i=f.Instances[s],r=!0)),r&&i.safeInitialize(e.toObject()),e.set({model:i})}else if("collection"===e.get("scope")){f.Collections.has(e.get("entity"))||f.Collections.set(e.get("entity"),new f.Collections.Generic(e.toObject()));var l=f.Collections.get(e.get("entity"));!l.initialized&&e.get("fetch")&&l.safeInitialize(e.toObject()),e.set({collection:l})}if(null!==e.get("type")){var c=p.ucfirst(e.get("type"));if(void 0!==f.Views.Widgets[c]){var u=e.toObject();u.view=e,f.Instances[e.get("uid")]=new f.Views.Widgets[c](u),f.Instances[e.get("uid")].$el.attr("data-guid",e.get("uid")),p.has(f.Instances[e.get("uid")],"promise")?f.Instances[e.get("uid")].initializer.then(t,n):t(f.Instances[e.get("uid")])}else f.Environment.get("production")||console.warn("Stratus.Views.Widgets."+c+" is not correctly configured."),n(new f.Prototypes.Error({code:"WidgetLoader",message:"Stratus.Views.Widgets."+c+" is not correctly configured."},e.toObject()));!f.Environment.get("production")&&f.Environment.get("nestDebug")&&console.groupEnd()}else{var d=e.get("el").find("[data-type],[data-plugin]");0<d.length?f.Internals.Loader(e.get("el"),e,o).then(function(e){!f.Environment.get("production")&&f.Environment.get("nestDebug")&&console.groupEnd(),t(e)},function(e){!f.Environment.get("production")&&f.Environment.get("nestDebug")&&console.groupEnd(),n(new f.Prototypes.Error(e,d))}):!f.Environment.get("production")&&f.Environment.get("nestDebug")?(console.warn("No Innate or Nested Type Found:",e.toObject()),t(e.toObject()),console.groupEnd()):t(e.toObject())}},f.Internals.PluginLoader=function(n,o,i,e){var t=p.union([i.get("plugin")],i.get("plugins"));p.each(t,function(e){if(e=p.ucfirst(e),void 0!==f.Views.Plugins[e]){var t=i.toObject();t.view=i,f.Instances[i.get("uid")]=new f.Views.Plugins[e](t),f.Instances[i.get("uid")].$el.attr("data-guid",i.get("uid")),p.has(f.Instances[i.get("uid")],"promise")?f.Instances[i.get("uid")].initializer.then(n,o):n(f.Instances[i.get("uid")])}else f.Environment.get("production")||console.warn("Stratus.Views.Plugins."+e+" is not correctly configured."),o(new f.Prototypes.Error({code:"PluginLoader",message:"Stratus.Views.Plugins."+e+" is not correctly configured."},i.toObject()))})},f.Loaders.Angular=function(){var i,s,r,a={requirement:[],module:[],stylesheet:[]},l=function(e){e=e||{},p.each(e,function(e,t){a[t]=a[t]||[],p.isArray(e)?p.each(e,function(e){a[t].push(e)}):a[t].push(e)})};p.each(f.Roster,function(n,e){if("object"==typeof n&&n)if(p.isUndefined(n.selector)&&n.namespace&&(n.selector=p.filter(p.map(requirejs.s.contexts._.config.paths,function(e,t){return p.startsWith(t,n.namespace)?("attribute"===n.type?"[":"")+p.camelToHyphen(t.replace(n.namespace,"stratus-"))+("attribute"===n.type?"]":""):null}))),p.isArray(n.selector))n.length=0,p.each(n.selector,function(e){if(s=document.querySelectorAll(e),n.length+=s.length,s.length){var t=e.replace(/^\[/,"").replace(/]$/,"");i=n.namespace+p.lcfirst(p.hyphenToCamel(t.replace(/^stratus/,"").replace(/^ng/,""))),p.has(requirejs.s.contexts._.config.paths,i)&&(r={requirement:i},n.module&&(r.module=p.isString(n.module)?n.module:p.lcfirst(p.hyphenToCamel(t+(n.suffix||"")))),l(r))}});else if(p.isString(n.selector)&&(s=document.querySelectorAll(n.selector),n.length=s.length,s.length)){var o=n.selector.replace(/^\[/,"").replace(/]$/,"");n.namespace?p.each(s,function(e){var t=e.getAttribute(o);t&&(i=n.namespace+p.lcfirst(p.hyphenToCamel(t.replace("Stratus",""))),p.has(requirejs.s.contexts._.config.paths,i)&&l({requirement:i}))}):n.require&&(a.requirement=p.union(a.requirement,n.require),r={},n.module&&(r.module=p.isString(n.module)?n.module:p.lcfirst(p.hyphenToCamel(o+(n.suffix||"")))),n.stylesheet&&(r.stylesheet=n.stylesheet),l(r))}}),a.requirement.push("angular-material"),p.each(a,function(e,t){a[t]=p.uniq(e)}),(window.container=a).requirement.length&&(Object.keys(requirejs.s.contexts._.config.paths).filter(function(e){return p.startsWith(e,"stratus.filters.")}).forEach(function(e){a.requirement.push(e)}),require(a.requirement,function(){if(angular.module("stratusApp",p.union(Object.keys(f.Modules),a.module)).config(["$sceDelegateProvider",function(e){var t=["self","http://*.sitetheory.io/**","https://*.sitetheory.io/**"];boot.host&&(p.startsWith(boot.host,"//")?p.each(["https:","http:"],function(e){t.push(e+boot.host+"/**")}):t.push(boot.host+"/**")),e.resourceUrlWhitelist(t)}]),"function"==typeof $&&$.fn&&$.FroalaEditor){$.FroalaEditor.DEFAULTS.key=f.Api.Froala;var e=["bold","italic","underline","strikeThrough","subscript","superscript","|","formatBlock","blockStyle","inlineStyle","paragraphStyle","paragraphFormat","align","formatOL","formatUL","outdent","indent","|","insertLink","insertImage","insertVideo","insertFile","insertTable","|","undo","redo","removeFormat","wordPaste","help","html","fullscreen"];angular.module("stratusApp").value("froalaConfig",{codeBeautifierOptions:{end_with_newline:!0,indent_inner_html:!0,extra_liners:"['p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote', 'pre', 'ul', 'ol', 'table', 'dl']",brace_style:"expand",indent_char:" ",indent_size:4,wrap_line_length:0},codeMirror:!0,codeMirrorOptions:{indentWithTabs:!1,lineNumbers:!0,lineWrapping:!0,mode:"text/html",tabMode:"space",tabSize:4},fileUploadURL:"https://app002.sitetheory.io:3000/?session="+p.cookie("SITETHEORY"),htmlAllowedAttrs:[".*"],htmlAllowedEmptyTags:["textarea","a",".fa","iframe","object","video","style","script","div"],htmlAllowedTags:[".*"],htmlRemoveTags:[""],htmlUntouched:!0,imageManagerPageSize:20,imageManagerScrollOffset:10,imageManagerLoadURL:"/Api/Media?payload-only=true",imageManagerLoadMethod:"GET",imageManagerDeleteMethod:"DELETE",multiLine:!0,pasteDeniedAttrs:[""],pasteDeniedTags:[""],pastePlain:!1,toolbarSticky:!1,toolbarButtons:e,toolbarButtonsMD:e,toolbarButtonsSM:e,toolbarButtonsXS:e})}p.each(f.Services,function(e){angular.module("stratusApp").config(e)}),p.each(f.Components,function(e,t){angular.module("stratusApp").component("stratus"+p.ucfirst(t),e)}),p.each(f.Directives,function(e,t){angular.module("stratusApp").directive("stratus"+p.ucfirst(t),e)}),p.each(f.Filters,function(e,t){angular.module("stratusApp").filter(p.lcfirst(t),e)}),p.each(f.Controllers,function(e,t){angular.module("stratusApp").controller(t,e)});var t=a.stylesheet,n=f("link[satisfies]").map(function(e){return e.getAttribute("satisfies")});if(p.contains(n,"angular-material.css")||t.push(f.BaseUrl+f.BundlePath+"bower_components/angular-material/angular-material"+(f.Environment.get("production")?".min":"")+".css"),(f("[froala]").length||f.Directives.Froala)&&[f.BaseUrl+"sitetheorycore/css/sitetheory.codemirror.css",f.BaseUrl+f.BundlePath+"bower_components/codemirror/lib/codemirror.css",f.BaseUrl+f.BundlePath+"bower_components/froala-wysiwyg-editor/css/froala_editor.min.css",f.BaseUrl+f.BundlePath+"bower_components/froala-wysiwyg-editor/css/froala_style.min.css",f.BaseUrl+f.BundlePath+"bower_components/froala-wysiwyg-editor/css/plugins/code_view.min.css",f.BaseUrl+f.BundlePath+"bower_components/froala-wysiwyg-editor/css/plugins/draggable.min.css",f.BaseUrl+f.BundlePath+"bower_components/froala-wysiwyg-editor/css/plugins/file.min.css",f.BaseUrl+f.BundlePath+"bower_components/froala-wysiwyg-editor/css/plugins/fullscreen.min.css",f.BaseUrl+f.BundlePath+"bower_components/froala-wysiwyg-editor/css/plugins/help.min.css",f.BaseUrl+f.BundlePath+"bower_components/froala-wysiwyg-editor/css/plugins/image.min.css",f.BaseUrl+f.BundlePath+"bower_components/froala-wysiwyg-editor/css/plugins/image_manager.min.css",f.BaseUrl+f.BundlePath+"bower_components/froala-wysiwyg-editor/css/plugins/quick_insert.min.css",f.BaseUrl+f.BundlePath+"bower_components/froala-wysiwyg-editor/css/plugins/special_characters.min.css",f.BaseUrl+f.BundlePath+"bower_components/froala-wysiwyg-editor/css/plugins/table.min.css",f.BaseUrl+f.BundlePath+"bower_components/froala-wysiwyg-editor/css/plugins/video.min.css"].forEach(function(e){t.push(e)}),t.length){var o=0;p.each(t,function(e){f.Internals.CssLoader(e).then(function(){++o===t.length&&angular.bootstrap(document.querySelector("html"),["stratusApp"])})})}else angular.bootstrap(document.querySelector("html"),["stratusApp"])}))},f.Instances.Clean=function(e){if(void 0===e?console.error("Stratus.Instances.Clean() requires a string or array containing Unique ID(s)."):"string"==typeof e&&(e=[e]),"object"!=typeof e||!Array.isArray(e))return!1;p.each(e,function(e){p.has(f.Instances,e)&&("function"==typeof f.Instances[e].remove&&f.Instances[e].remove(),delete f.Instances[e])})},f.Chronos=p.extend(new f.Prototypes.Model,{initialize:function(e){f.Environment.get("production")||console.info("Chronos Invoked!"),this.on("change",this.synchronize,this)},synchronize:function(){p.each(this.changed,function(e,t){"string"==typeof t&&-1!==t.indexOf(".")&&(t=p.first(t.split(".")),e=this.get(t)),!e.code&&e.enabled?e.code=setInterval(function(e){e.method.call(e.scope)},1e3*e.time,e):e.code&&!e.enabled&&(clearInterval(e.code),e.code=0)},this)},add:function(e,t,n){var o=null,i=new f.Prototypes.Job(e,t,n);return null!==i.time&&"function"==typeof i.method&&(o=p.uniqueId("job_"),this.set(o,i),f.Instances[o]=i),o},enable:function(e){var t=this.has(e);return t&&this.set(e+".enabled",!0),t},disable:function(e){var t=this.has(e);return t&&this.set(e+".enabled",!1),t},toggle:function(e,t){var n=this.has(e);return n&&this.set(e+".enabled","boolean"==typeof t?t:!this.get(e+".enabled")),n}}),f.Chronos.reinitialize(),f.PostMessage.Convoy=function(t){window.addEventListener("message",function(e){if("https://auth.sitetheory.io"!==e.origin)return!1;t(p.isJSON(e.data)?JSON.parse(e.data):{})},!1)},f.PostMessage.Convoy(function(e){var t=p.cookie("sso");(t=null===t||!!p.isJSON(t)&&JSON.parse(t))&&e&&e.meta&&e.meta.session&&e.meta.session!==p.cookie("SITETHEORY")&&(p.cookie({name:"SITETHEORY",value:e.meta.session,expires:"1w"}),f.Client.safari||window.location.reload(!0))}),f.LocalStorage.Listen=function(t,n){window.addEventListener("storage",function(e){e.key===t&&n(e)},!1)},f.LocalStorage.Listen("stratus-core",function(e){console.log("LocalStorage:",e)}),f.DOM.ready=function(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)},f.DOM.complete=function(e){"complete"===document.readyState?e():window.addEventListener("load",e)},f.DOM.unload=function(e){window.addEventListener("beforeunload",e)},f.Key.Enter=13,f.Key.Escape=27,f.Events.on("initialize",function(){f.Environment.get("production")||(console.groupEnd(),console.group("Stratus Initialize")),f.Internals.LoadEnvironment(),f.Internals.Compatibility(),f.RegisterGroup=new f.Prototypes.Model,f.Internals.TrackLocation(),f.Loaders.Angular(),f.Internals.Loader().then(function(e){f.Environment.get("production")||console.info("Views:",e),window.views=e,f.Events.on("finalize",function(e){"undefined"==typeof Backbone||Backbone.History.started||Backbone.history.start(),f.Events.trigger("finalized",e)}),f.Events.trigger("finalize",e)},function(e){console.error("Stratus Loader:",e)})}),f.Events.on("finalize",function(){if(f.Environment.get("production")||(console.groupEnd(),console.group("Stratus Finalize")),"object"==typeof Backbone){f.Internals.Anchor.initialize&&(f.Internals.Anchor=f.Internals.Anchor());var e=new f.Internals.Anchor;f.Environment.get("production")||console.log("anchor:",e)}f.RegisterGroup.size()&&f.RegisterGroup.each(function(e,t){p.has(f.Internals,t)&&f.Internals[t](e)})}),f.Events.on("terminate",function(){f.Environment.get("production")||(console.groupEnd(),console.group("Stratus Terminate"))}),f.Events.on("alert",function(e,t){e instanceof f.Prototypes.Bootbox||(e=new f.Prototypes.Bootbox(e,t)),"undefined"!=typeof bootbox?bootbox.alert(e.message,e.handler):(window.alert(e.message),e.handler())}),f.Events.on("confirm",function(e,t){e instanceof f.Prototypes.Bootbox||(e=new f.Prototypes.Bootbox(e,t)),"undefined"!=typeof bootbox?bootbox.confirm(e.message,e.handler):t(window.confirm(e.message))}),f.Events.on("notification",function(e,t){var n,o={};e&&"object"==typeof e?(p.extend(o,e),o.message=o.message||"Message"):o.message=e||"Message",o.title=o.title||t||"Stratus",o.icon=o.icon||"https://avatars0.githubusercontent.com/u/15791995?v=3&s=200","Notification"in window?"granted"===window.Notification.permission?(n=new window.Notification(o.title,{body:o.message,icon:o.icon}),f.Environment.get("production")||console.log(n)):"denied"!==window.Notification.permission&&window.Notification.requestPermission(function(e){"granted"===e&&(n=new window.Notification(o.title,{body:o.message,icon:o.icon}),f.Environment.get("production")||console.log(n))}):console.info("This browser does not support desktop notifications.  You should switch to a modern browser.")}),f.Events.on("toast",function(e,t,n,o){e instanceof f.Prototypes.Toast||(e=new f.Prototypes.Toast(e,t,n,o)),f.Environment.get("production")||console.log("Toast:",e),"undefined"!=typeof $&&$.toaster?$.toaster(e):f.Events.trigger("alert",e.message)}),f.DOM.ready(function(){f("body").removeClass("loaded unloaded").addClass("loading"),f.Events.trigger("initialize")}),f.DOM.complete(function(){f("body").removeClass("loading unloaded").addClass("loaded")}),f.DOM.unload(function(e){f("body").removeClass("loading loaded").addClass("unloaded"),f.Events.trigger("terminate",e)}),f});