<div
        [attr.id]="elementId"
        [formGroup]="form"
>
    <mat-form-field style="width: 100%;" [class.payment-selected]="form.controls[fieldName].value">
        <mat-label>Payment Method</mat-label>
        <mat-select
                [panelClass]="'sa-stripe-payment-method-selector-select-override'"
                formControlName="{{fieldName}}"
                [compareWith]="objectComparisonFunction"
        >
            <!-- TODO fine a way to display certain data formatted. `form.controls.dataNumber.value` is the saved id -->
            <mat-select-trigger>
                <sa-stripe-payment-method-item *ngIf="form.controls[fieldName].value" [(model)]="form.controls[fieldName].value"></sa-stripe-payment-method-item>
                <!--{{form.controls.dataNumber.value && form.controls.dataNumber.value.data ? form.controls.dataNumber.value.data.id : 'Not Selected'}}-->
            </mat-select-trigger>
            <mat-option
                    class="no-results"
                    *ngIf="paymentCollection.completed && !paymentCollection.pending && paymentCollection.models.length === 0"
                    [disabled]="true"
            >
                No Payment Methods on file.
            </mat-option>
            <mat-option class="current-selection" *ngIf="form.controls[fieldName].value">
                <sa-stripe-payment-method-item [(model)]="form.controls[fieldName].value"></sa-stripe-payment-method-item>
            </mat-option>
            <mat-option
                    *ngFor="let paymentMethod of paymentCollection.models"
                    [value]="paymentMethod"
            >
                <sa-stripe-payment-method-item [(model)]="paymentMethod" [editable]="true"></sa-stripe-payment-method-item>
            </mat-option>
            <mat-option
                    [hidden]="!paymentCollection.completed || paymentCollection.pending"
                    [disabled]="true"
            >
                <sa-stripe-setup-intent data-detailed-billing-info="true"></sa-stripe-setup-intent>
            </mat-option>
        </mat-select>
    </mat-form-field>
</div>
